<!DOCTYPE html>
<html lang="en-gb">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>John L. Godlee</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    
  </head>

  <body>
    <nav>
    <ul class="menu">
      
      <li><a href="/">John L. Godlee</a></li>
      
      <li><a href="/files/cv/john_l_godlee_cv.pdf">CV</a></li>
      
      <li><a href="/works">Works</a></li>
      
    </ul>
    <hr/>
    </nav>


<div>
<h1>Tracking meals for a year</h1>

<h2>2022-08-16</h2>
</div>

<main>
<p>I&rsquo;ve just finished an experiment where I tracked what meals I ate for just over a year. I did it for 460 days in total.</p>
<p>The original goal was to keep a reference to provide inspiration for what to cook when I can&rsquo;t think of anything. I realised that my cooking and eating habits have changed since I first moved away from home about 10 year ago, and I have forgotten many of the dishes I used to cook.</p>
<p>A second goal arose when I started the project, which was to track how many meals I eat &ldquo;out&rdquo;, i.e. paid for somebody else to cook in a restaurant, fast food place, cafe etc. I was suspicious that I probably ate out more than I admitted, and cooking at home is a good way to save money and stay healthy.</p>
<p>Collecting the data was quite easy. When I was living in London I drew a table on paper and stuck it to the wall above the kitchen table. When I moved to Edinburgh and I started working in the office again I transitioned to using an excel spreadsheet kept on my Desktop, so it remained visible and I wouldn&rsquo;t forget to fill it out.</p>
<p>The only times I found it difficult to keep the log was when I was travelling abroad, as my routine was disrupted. Even then, I tried to backdate the log as best as I could.</p>
<p>In order to analyse the data in a meaningful way I had to spend a long time at the end recoding the entries. At the time of recording I didn&rsquo;t attempt to standardise how I recorded a meal, so I had lots of very similar entries like &ldquo;Eggs on toast&rdquo;, &ldquo;Fried egg&rdquo;, and &ldquo;Fried egg on toast&rdquo;. I decided that the best way to recode the responses, rather than just combining values to something like &ldquo;Egg toast&rdquo;, was to add a variable number of tags to each entry. So all the above entries would get the tag of &ldquo;bread&rdquo;, &ldquo;egg&rdquo;, and &ldquo;toast&rdquo;. The tags describe the main ingredients in the dish, the cooking or preparation method, and sometimes the food culture I think the dish is from. Even with this system there are ambiguities that required me to make a decision. Should a tortilla be classified as &ldquo;bread&rdquo;, or is it it&rsquo;s own thing like &ldquo;flatbread&rdquo;?</p>
<p>I used R to recode and process the data.</p>
<p>The original spreadsheet looked like this:</p>
<table>
  <thead>
      <tr>
          <th>date</th>
          <th>breakfast</th>
          <th>lunch</th>
          <th>supper</th>
          <th>location</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>2022-08-20</td>
          <td>Cereal</td>
          <td>Falafel wrap</td>
          <td>NOTHING</td>
          <td>Edinburgh</td>
      </tr>
      <tr>
          <td>2022-08-21</td>
          <td>Toast and peanut butter</td>
          <td>Sandwich (OUT)</td>
          <td>Lentil salad</td>
          <td>Edinburgh</td>
      </tr>
  </tbody>
</table>
<p>The first this was to transform the table to a long format:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#000">x</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">pivot_longer</span><span style="color:#000;font-weight:bold">(</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">names_to</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;meal&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">cols</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">c</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;breakfast&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;lunch&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;supper&#34;</span><span style="color:#000;font-weight:bold">))</span>
</span></span></code></pre></div><p>Then I added an ID value to each meal, recoded the date, and created two extra columns: <code>out</code> and <code>nothing</code>, which were logical based on whether the strings &ldquo;OUT&rdquo; and &ldquo;NOTHING&rdquo; were found in the meal entry. Then I set out adding tags to each meal, separated by a semi-colon.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#000">x</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#000">mutate</span><span style="color:#000;font-weight:bold">(</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">meal_id</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">row_number</span><span style="color:#000;font-weight:bold">(),</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">date</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">as.Date</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">date</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">out</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">ifelse</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">grepl</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;OUT&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">value</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">FALSE</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">nothing</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">ifelse</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">grepl</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;NOTHING&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">value</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">FALSE</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">value</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">trimws</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">na_if</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">gsub</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;\\(OUT\\)&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">value</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#4e9a06">&#34;NA&#34;</span><span style="color:#000;font-weight:bold">)),</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">tag</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">case_when</span><span style="color:#000;font-weight:bold">(</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">value</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#4e9a06">&#34;Aloo paratha&#34;</span> <span style="color:#ce5c00;font-weight:bold">~</span> <span style="color:#4e9a06">&#34;flatbread;potato&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">value</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#4e9a06">&#34;Apple&#34;</span> <span style="color:#ce5c00;font-weight:bold">~</span> <span style="color:#4e9a06">&#34;fruit;apple&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">value</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#4e9a06">&#34;Aubergeine curry&#34;</span> <span style="color:#ce5c00;font-weight:bold">~</span> <span style="color:#4e9a06">&#34;curry;aubergeine&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span></code></pre></div><p>I also filtered out meals from incomplete months at the start and end of the survey period, so I could calculate unbiased monthly statistics. I separated out the tags, so a meal may span multiple lines, depending on how many tags it has. Finally, I added a logical column which adds a FALSE where tag &ldquo;meat&rdquo; is encountered.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#000">x</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>	<span style="color:#000">filter</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">date</span> <span style="color:#ce5c00;font-weight:bold">&gt;=</span> <span style="color:#000">as.Date</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;2021-05-01&#34;</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#000">date</span> <span style="color:#ce5c00;font-weight:bold">&lt;=</span> <span style="color:#000">as.Date</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;2022-07-31&#34;</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#000">separate_rows</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">tag</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">sep</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;;&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#000">mutate</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">vegetarian</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">ifelse</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">tag</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#4e9a06">&#34;meat&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">FALSE</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">))</span>
</span></span></code></pre></div><p>The final table looked like this:</p>
<table>
  <thead>
      <tr>
          <th>date</th>
          <th>meal</th>
          <th>value</th>
          <th>meal_id</th>
          <th>out</th>
          <th>nothing</th>
          <th>tag</th>
          <th>vegetarian</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>2022-08-20</td>
          <td>breakfast</td>
          <td>Cereal</td>
          <td>1</td>
          <td>FALSE</td>
          <td>FALSE</td>
          <td>cereal</td>
          <td>TRUE</td>
      </tr>
      <tr>
          <td>2022-08-20</td>
          <td>lunch</td>
          <td>Falafel wrap</td>
          <td>2</td>
          <td>FALSE</td>
          <td>FALSE</td>
          <td>falafel</td>
          <td>TRUE</td>
      </tr>
      <tr>
          <td>2022-08-20</td>
          <td>lunch</td>
          <td>Falafel wrap</td>
          <td>2</td>
          <td>FALSE</td>
          <td>FALSE</td>
          <td>tortilla</td>
          <td>TRUE</td>
      </tr>
      <tr>
          <td>2022-08-20</td>
          <td>supper</td>
          <td>NOTHING</td>
          <td>3</td>
          <td>FALSE</td>
          <td>TRUE</td>
          <td>NA</td>
          <td>TRUE</td>
      </tr>
  </tbody>
</table>
<p>I made a plot of the number of meals I missed per month:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#000">meals_clean</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#000">group_by</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">meal_id</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">date</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">summarise</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">nothing</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">any</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">nothing</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#000">mutate</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">month</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">floor_date</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">date</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;month&#34;</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#000">group_by</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">month</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#000">summarise</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">sum_nothing</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">sum</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">nothing</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#000">ggplot</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">.,</span> <span style="color:#000">aes</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">month</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">y</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">sum_nothing</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">+</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#000">geom_line</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">+</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#000">geom_point</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">shape</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">21</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">fill</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;darkgrey&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">+</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#000">scale_x_date</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">date_breaks</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;1 month&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">date_labels</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;%b %Y&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">guide</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">guide_axis</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">angle</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">45</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">+</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#000">labs</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;Date&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">y</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;Meals missed per month&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">theme_bw</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">+</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#000">theme</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">panel.grid.minor</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">element_blank</span><span style="color:#000;font-weight:bold">())</span>
</span></span></code></pre></div><figure><a href="/img_full/meals_year/missed.png"><img
          alt="Meals missed per month"
          title="Meals missed per month"src="/img/meals_year/missed.png" 
      /></a></figure>


<p>There seems to be a fairly regular oscillation where I miss meals fairly regularly on month, then rarely the next month. May 2022 is a big outlier, as I was travelling a lot and eating at irregular times. It&rsquo;s possible that eating out has increased since I moved from London to Edinburgh in September 2022, as we live closer to the centre of the city and COVID restrictions have eased, but it&rsquo;s difficult to tell from such noisy data.</p>
<p>Meals missed broken down by meal type:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#000">meals_clean</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#000">group_by</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">meal_id</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">date</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">meal</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#000">summarise</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">nothing</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">any</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">nothing</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#000">group_by</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">meal</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#000">summarise</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">sum_nothing</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">sum</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">nothing</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#000">ggplot</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">.,</span> <span style="color:#000">aes</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">meal</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">y</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">sum_nothing</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">+</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#000">geom_bar</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stat</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;identity&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">colour</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;black&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">fill</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;darkgrey&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">+</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#000">labs</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;Meal&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">y</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;Meals missed&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">theme_bw</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">+</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#000">theme</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">panel.grid.minor</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">element_blank</span><span style="color:#000;font-weight:bold">())</span>
</span></span></code></pre></div><figure><a href="/img_full/meals_year/missed_meal.png"><img
          alt="Missed meals by meal type"
          title="Missed meals by meal type"src="/img/meals_year/missed_meal.png" 
      /></a></figure>


<p>This doesn&rsquo;t surprise me. Breakfast is an important meal for me, as it helps me to wake up, but sometimes I miss evening meals if I have had a big lunch or I&rsquo;m doing something in the evening.</p>
<p>A monthly timeline of meals eaten out:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#000">meals_clean</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">group_by</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">meal_id</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">date</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#000">summarise</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">out</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">any</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">out</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#000">group_by</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">month</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">floor_date</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">date</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;month&#34;</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#000">group_by</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">month</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#000">summarise</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">sum_out</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">sum</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">out</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">ggplot</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">.,</span> <span style="color:#000">aes</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">month</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">y</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">sum_out</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">+</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#000">geom_line</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">+</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#000">geom_point</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">shape</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">21</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">fill</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;darkgrey&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">+</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#000">scale_x_date</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">date_breaks</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;1 month&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">date_labels</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;%b %Y&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">guide</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">guide_axis</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">angle</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">45</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">+</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#000">labs</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;Date&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">y</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;Meals out per month&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">theme_bw</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">+</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#000">theme</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">panel.grid.minor</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">element_blank</span><span style="color:#000;font-weight:bold">())</span>
</span></span></code></pre></div><figure><a href="/img_full/meals_year/out.png"><img
          alt="Meals eaten out per month"
          title="Meals eaten out per month"src="/img/meals_year/out.png" 
      /></a></figure>


<p>On average I eat 10.33 meals out per month, from a total of ~90 meals per month. That&rsquo;s not bad. September 2021 is particularly low because I was living with my parents in the countryside, so few opportunities to eat out. April 2022 is also low because I was on fieldwork in Angola, where most of our meals we cooked ourselves or were cooked by someone we employed in the National Park.</p>
<p>and non-vegetarian meals:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#000">meals_clean</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#000">group_by</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">meal_id</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">date</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#000">summarise</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">vegetarian</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">any</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">vegetarian</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">na.rm</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#000">group_by</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">month</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">floor_date</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">date</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;month&#34;</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#000">group_by</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">month</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#000">summarise</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">sum_meat</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">sum</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">vegetarian</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">ggplot</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">.,</span> <span style="color:#000">aes</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">month</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">y</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">sum_meat</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">+</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#000">geom_line</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">+</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#000">geom_point</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">shape</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">21</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">fill</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;darkgrey&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">+</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#000">scale_x_date</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">date_breaks</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;1 month&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">date_labels</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;%b %Y&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">guide</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">guide_axis</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">angle</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">45</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">+</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#000">labs</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;Date&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">y</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;Meaty meals per month&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">theme_bw</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">+</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#000">theme</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">panel.grid.minor</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">element_blank</span><span style="color:#000;font-weight:bold">())</span>
</span></span></code></pre></div><figure><a href="/img_full/meals_year/meat.png"><img
          alt="Meaty meals per month"
          title="Meaty meals per month"src="/img/meals_year/meat.png" 
      /></a></figure>


<p>May 2022 is particularly hight because I was in Mexico on holiday and decided to eat whatever I wanted, including lots of carne asada and cochinita pibil.</p>
<p>Finally, a breakdown of the most common tags by meal type:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#000">meals_clean</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#000">filter</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">is.na</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">tag</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#000">group_by</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">tag</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">meal</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#000">tally</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#000">group_by</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">meal</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#000">mutate</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">n_meals</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">sum</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">n</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#000">group_by</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">meal</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">tag</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#000">mutate</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">prop</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">n</span> <span style="color:#ce5c00;font-weight:bold">/</span> <span style="color:#000">n_meals</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#000">group_by</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">meal</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#000">slice_max</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">prop</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">n</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">10</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">with_ties</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">FALSE</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">ggplot</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">.,</span> <span style="color:#000">aes</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">reorder_within</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">tag</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#000">prop</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">meal</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#000">y</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">prop</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">+</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#000">geom_bar</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stat</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;identity&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">fill</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;darkgrey&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">colour</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;black&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">+</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#000">geom_label</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">aes</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">label</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">n</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">+</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#000">scale_x_discrete</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">name</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">NULL</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">labels</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">function</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000">sub</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;^(.*)___.*$&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;\\1&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">x</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">facet_wrap</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">~</span><span style="color:#000">meal</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">scales</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;free_x&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">nrow</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">+</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#000">labs</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;Breakfast&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">y</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;Proportion&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">theme_bw</span><span style="color:#000;font-weight:bold">()</span> 
</span></span></code></pre></div><figure><a href="/img_full/meals_year/tags.png"><img
          alt="Breakdown of most popular tags by meal type"
          title="Breakdown of most popular tags by meal type"src="/img/meals_year/tags.png" 
      /></a></figure>


<p>This didn&rsquo;t work out as nicely as I&rsquo;d hoped. Bread comes out on top for all meal types, but that&rsquo;s not particularly interesting. I eat a lot of sandwiches for lunch (which contain bread), and toast for breakfast. The tag system doesn&rsquo;t really capture the essence of the meal. But it&rsquo;s very hard to classify individual meals because they overlap so much and are so variable.</p>
<p>I had a stab at creating a network graph for the most commonly shared tags per meal, as I&rsquo;ve been playing with <code>{igraph}</code> recently.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Create list of dataframes of edges, with freq. per meal type</span>
</span></span><span style="display:flex;"><span><span style="color:#000">tag_edges</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">meals_clean</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#000">dplyr</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">select</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">meal</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">meal_id</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">tag</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#000">group_by</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">meal</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">meal_id</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#000">filter</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">n</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#000">do</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">data.frame</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">t</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">combn</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">.$tag</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">))))</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#000">ungroup</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#000">dplyr</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">select</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#000">meal_id</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#000">group_by</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">meal</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">X1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">X2</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#000">tally</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#000">rename</span><span style="color:#000;font-weight:bold">(</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">from</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">X1</span><span style="color:#000;font-weight:bold">,</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#000">to</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">X2</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">weight</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">n</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#000">ungroup</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#000">split</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">.,</span> <span style="color:#000">.$meal</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># For each meal type dataframe</span>
</span></span><span style="display:flex;"><span><span style="color:#000">tag_graph_list</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">lapply</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">tag_edges</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">function</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic"># Create a graph object</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">tag_graph</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">x</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#000">dplyr</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">select</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#000">meal</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#000">filter</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">weight</span> <span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#000">graph.data.frame</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#000">as.undirected</span><span style="color:#000;font-weight:bold">()</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic"># Create a plot</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">ggraph</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">tag_graph</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">layout</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#39;linear&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">circular</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">+</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#000">geom_edge_link</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">aes</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">width</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">weight</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">+</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#000">geom_node_label</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">aes</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">label</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">name</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">+</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#000">ggtitle</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">unique</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">meal</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">+</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#000">theme_graph</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">+</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#000">theme</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">legend.position</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;none&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">})</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Use patchwork to mosaic plots</span>
</span></span><span style="display:flex;"><span><span style="color:#000">wrap_plots</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">tag_graph_list</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">ncol</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">)</span>
</span></span></code></pre></div><figure><a href="/img_full/meals_year/conns.png"><img
          alt="Most common tag connections per meal type"
          title="Most common tag connections per meal type"src="/img/meals_year/conns.png" 
      /></a></figure>


<p>Lots of eggs on toast for breakfast, or bananas with other stuff. Sandwiches with salad, cheese and salad for lunch. Curries, tomato pasta, and rice with beans and vegetables.</p>
<p>If I was to do this again I&rsquo;d try harder to be more descriptive in the contents of the meals I ate. Rather than just &ldquo;pasta&rdquo;, &ldquo;pasta with mushrooms, courgettes, tomato-based sauce, and crusty bread&rdquo;.</p>

</main>

  <footer>
  <hr/>
  John L. Godlee | 
  <a href="mailto:johngodlee@gmail.com">johngodlee@gmail.com</a> |
  <a href="http://johngodlee.xyz//index.xml">RSS</a>

  </footer>
  </body>
</html>

