<!DOCTYPE html>
<html lang="en-gb">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>John L. Godlee</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    
  </head>

  <body>
    <nav>
    <ul class="menu">
      
      <li><a href="/">John L. Godlee</a></li>
      
      <li><a href="/files/cv/john_l_godlee_cv.pdf">CV</a></li>
      
      <li><a href="/works">Works</a></li>
      
    </ul>
    <hr/>
    </nav>


<div>
<h1>SEOSAW plot metadata Shiny app</h1>

<h2>2021-11-26</h2>
</div>

<main>
<p>I have built a <a href="https://johngodlee.shinyapps.io/shiny_data_explorer/" target="_blank">web app</a>
 to make it easier to quickly filter plots in the <a href="https://seosaw.github.io/" target="_blank">SEOSAW network</a>
 based on plot metadata and attributes of the plot. I built the app using <a href="https://shiny.rstudio.com/" target="_blank">Shiny</a>
, which offers a neat solution for creating simple HTML5 web apps in R.</p>
<p>I&rsquo;ve pasted the code for the app below. The app is actually fairly simple. It has a sidebar with a bunch of sliders and dropdown checkbox options to filter a dataframe of plot metadata. The main panel has a map displaying the plot locations, with the points optionally shaded according to one of the fields of plot metadata. The map is built using <a href="https://rstudio.github.io/leaflet/" target="_blank">leaflet</a>
, and pulls background tiles from <a href="https://www.mapbox.com/" target="_blank">mapbox</a>
. Below the map is a table showing the selected plots with their metadata values.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Packages</span>
</span></span><span style="display:flex;"><span><span style="color:#000">library</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">shiny</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000">library</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">dplyr</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000">library</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">sf</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000">library</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">leaflet</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000">library</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">shinyWidgets</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000">library</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">DT</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000">library</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">scico</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Import data</span>
</span></span><span style="display:flex;"><span><span style="color:#000">plots_clean_sf</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">readRDS</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;plots_clean_sf.rds&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000">species</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">readRDS</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;species.rds&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Country names lookup </span>
</span></span><span style="display:flex;"><span><span style="color:#000">africa_lookup</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">readRDS</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;africa_lookup.rds&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Column names lookup</span>
</span></span><span style="display:flex;"><span><span style="color:#000">column_lookup</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">readRDS</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;column_lookup.rds&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Construct mapbox URL </span>
</span></span><span style="display:flex;"><span><span style="color:#000">mbox_base</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#4e9a06">&#34;https://api.mapbox.com/&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">mbox_id</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#4e9a06">&#34;styles/v1/mapbox/streets-v11/tiles/{z}/{x}/{y}?access_token=&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">mbox_token</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#4e9a06">&#34;redacted&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">mapbox_url</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">paste0</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">mbox_base</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">mbox_id</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">mbox_token</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Define some functions for inputs to cut down on code replication</span>
</span></span><span style="display:flex;"><span><span style="color:#000">pickerInputFunc</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#204a87;font-weight:bold">function</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">id</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">name</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">choices</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">rem_na</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">FALSE</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">out</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">list</span><span style="color:#000;font-weight:bold">(</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">pickerInput</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">id</span><span style="color:#000;font-weight:bold">,</span> 
</span></span><span style="display:flex;"><span>        <span style="color:#000">column_lookup[[name]]</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">html</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">choices</span><span style="color:#000;font-weight:bold">,</span> 
</span></span><span style="display:flex;"><span>        <span style="color:#000">options</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">list</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">`actions-box`</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">`live-search`</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">),</span> 
</span></span><span style="display:flex;"><span>        <span style="color:#000">selected</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">choices</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">multiple</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">rem_na</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span> 
</span></span><span style="display:flex;"><span>      <span style="color:#000">out[[2]]</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">checkboxInput</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">paste0</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">id</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;NA&#34;</span><span style="color:#000;font-weight:bold">),</span> 
</span></span><span style="display:flex;"><span>        <span style="color:#000">label</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">paste</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Include NA values?&#34;</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#000">value</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">return</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">out</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">sliderInputFunc</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#204a87;font-weight:bold">function</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">id</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">name</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">x</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">rem_na</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">FALSE</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">lo</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">floor</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">min</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">na.rm</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">))</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">hi</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">ceiling</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">max</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">na.rm</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">))</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">out</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">list</span><span style="color:#000;font-weight:bold">(</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">numericRangeInput</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">id</span><span style="color:#000;font-weight:bold">,</span> 
</span></span><span style="display:flex;"><span>      <span style="color:#000">column_lookup[[name]]</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">html</span><span style="color:#000;font-weight:bold">,</span> 
</span></span><span style="display:flex;"><span>      <span style="color:#000">min</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">lo</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">max</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">hi</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">value</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">c</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">lo</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">hi</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">rem_na</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">out[[2]]</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">checkboxInput</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">paste0</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">id</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;NA&#34;</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">label</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">paste</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Include NA values?&#34;</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#000">value</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">return</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">out</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># UI</span>
</span></span><span style="display:flex;"><span><span style="color:#000">ui</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">fluidPage</span><span style="color:#000;font-weight:bold">(</span>
</span></span><span style="display:flex;"><span> <span style="color:#000">tags</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">head</span><span style="color:#000;font-weight:bold">(</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">tags</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">style</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">HTML</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;.leaflet-container { background: white; border-radius: 5px; border: 1px solid black; }&#34;</span><span style="color:#000;font-weight:bold">))</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">titlePanel</span><span style="color:#000;font-weight:bold">(</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">tagList</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">span</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;SEOSAW plot data explorer&#34;</span><span style="color:#000;font-weight:bold">,</span> 
</span></span><span style="display:flex;"><span>        <span style="color:#000">span</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">actionButton</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;more_info&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;More information&#39;</span><span style="color:#000;font-weight:bold">),</span> 
</span></span><span style="display:flex;"><span>          <span style="color:#000">style</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;position: absolute; right: 2em;&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">),</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#000">windowTitle</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;SEOSAW plot data explorer&#34;</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">sidebarLayout</span><span style="color:#000;font-weight:bold">(</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">sidebarPanel</span><span style="color:#000;font-weight:bold">(</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">style</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;overflow-y: auto; height: 90vh;&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">selectInput</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;pointHiSel&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Shade points&#34;</span><span style="color:#000;font-weight:bold">,</span> 
</span></span><span style="display:flex;"><span>        <span style="color:#000">c</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;None&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">unname</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">unlist</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">lapply</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">column_lookup</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;[[&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;label&#34;</span><span style="color:#000;font-weight:bold">)))),</span> 
</span></span><span style="display:flex;"><span>        <span style="color:#000">selected</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;None&#34;</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">pickerInput</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;speciesSel&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Species&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">unique</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">species</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">species</span><span style="color:#000;font-weight:bold">),</span> 
</span></span><span style="display:flex;"><span>        <span style="color:#000">options</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">list</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">`actions-box`</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">`live-search`</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">),</span> 
</span></span><span style="display:flex;"><span>        <span style="color:#000">selected</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">unique</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">species</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">species</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#000">multiple</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">pickerInputFunc</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;siteSel&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;site&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">unique</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">plots_clean_sf</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">site</span><span style="color:#000;font-weight:bold">)),</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">pickerInputFunc</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;country_iso3Sel&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;country_iso3&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">africa_lookup</span><span style="color:#000;font-weight:bold">),</span> 
</span></span><span style="display:flex;"><span>      <span style="color:#000">pickerInputFunc</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;prinvSel&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;prinv&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">unique</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">plots_clean_sf</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">prinv</span><span style="color:#000;font-weight:bold">)),</span> 
</span></span><span style="display:flex;"><span>      <span style="color:#000">pickerInputFunc</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;permanentSel&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;permanent&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">unique</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">plots_clean_sf</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">permanent</span><span style="color:#000;font-weight:bold">)),</span> 
</span></span><span style="display:flex;"><span>      <span style="color:#000">pickerInputFunc</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;plot_shapeSel&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;plot_shape&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">unique</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">plots_clean_sf</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">plot_shape</span><span style="color:#000;font-weight:bold">)),</span> 
</span></span><span style="display:flex;"><span>      <span style="color:#000">pickerInputFunc</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;teow_biomeSel&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;teow_biome&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">unique</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">plots_clean_sf</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">teow_biome</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#000">rem_na</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">pickerInputFunc</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;whites_veg_minorSel&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;whites_veg_minor&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">unique</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">plots_clean_sf</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">whites_veg_minor</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#000">rem_na</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">sliderInputFunc</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;plot_areaSel&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;plot_area&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">plots_clean_sf</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">plot_area</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">sliderInputFunc</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;longitudeSel&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;longitude&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">plots_clean_sf</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">longitude</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">sliderInputFunc</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;latitudeSel&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;latitude&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">plots_clean_sf</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">latitude</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">sliderInputFunc</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;elevationSel&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;elevation&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">plots_clean_sf</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">elevation</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">rem_na</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">sliderInputFunc</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;min_diam_threshSel&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;min_diam_thresh&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">plots_clean_sf</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">min_diam_thresh</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">rem_na</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">sliderInputFunc</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;ba_haSel&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;ba_ha&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">plots_clean_sf</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">ba_ha</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">sliderInputFunc</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;agb_haSel&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;agb_ha&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">plots_clean_sf</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">agb_ha</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">rem_na</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">sliderInputFunc</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;n_stems_ge5Sel&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;n_stems_ge5&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">plots_clean_sf</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">n_stems_ge5</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">sliderInputFunc</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;richnessSel&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;richness&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">plots_clean_sf</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">richness</span><span style="color:#000;font-weight:bold">),</span> 
</span></span><span style="display:flex;"><span>      <span style="color:#000">sliderInputFunc</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;n_censusSel&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;n_census&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">plots_clean_sf</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">n_census</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>	    <span style="color:#000">sliderInputFunc</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;bio1Sel&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;bio1&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">plots_clean_sf</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">bio1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">rem_na</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>	    <span style="color:#000">sliderInputFunc</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;bio12Sel&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;bio12&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">plots_clean_sf</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">bio12</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">rem_na</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>	    <span style="color:#000">sliderInputFunc</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;travel_time_citySel&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;travel_time_city&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">plots_clean_sf</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">travel_time_city</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">rem_na</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>	    <span style="color:#000">sliderInputFunc</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;forest_heightSel&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;forest_height&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">plots_clean_sf</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">forest_height</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">rem_na</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>	    <span style="color:#000">sliderInputFunc</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;soil_org_c_densitSel&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;soil_org_c_densit&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">plots_clean_sf</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">soil_org_c_densit</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">rem_na</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>	    <span style="color:#000">sliderInputFunc</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;soil_sandSel&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;soil_sand&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">plots_clean_sf</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">soil_sand</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">rem_na</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">mainPanel</span><span style="color:#000;font-weight:bold">(</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">leafletOutput</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;mapOutput&#34;</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">pickerInput</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;tableColSel&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Select columns&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">choices</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">unname</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">unlist</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">lapply</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">column_lookup</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;[[&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;label&#34;</span><span style="color:#000;font-weight:bold">))),</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">selected</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">unlist</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">unname</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">lapply</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">column_lookup</span><span style="color:#000">[c</span><span style="color:#000;font-weight:bold">(</span>
</span></span><span style="display:flex;"><span>          <span style="color:#4e9a06">&#34;plot_id&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;country_iso3&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;prinv&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;permanent&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;plot_area&#34;</span><span style="color:#000;font-weight:bold">,</span> 
</span></span><span style="display:flex;"><span>          <span style="color:#4e9a06">&#34;plot_shape&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;min_diam_thresh&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;n_census&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;agb_ha&#34;</span><span style="color:#000;font-weight:bold">,</span> 
</span></span><span style="display:flex;"><span>          <span style="color:#4e9a06">&#34;ba_ha&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;n_stems_ge5&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;richness&#34;</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000">]</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;[[&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;label&#34;</span><span style="color:#000;font-weight:bold">))),</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">multiple</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">options</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">list</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">`actions-box`</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">`live-search`</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">)),</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">DTOutput</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;tableOutput&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Server</span>
</span></span><span style="display:flex;"><span><span style="color:#000">server</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#204a87;font-weight:bold">function</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">input</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">output</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">session</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">plotsFil</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">reactive</span><span style="color:#000;font-weight:bold">({</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">plots_clean_sf</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>      <span style="color:#000">filter</span><span style="color:#000;font-weight:bold">(</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">plot_id</span> <span style="color:#ce5c00;font-weight:bold">%in%</span> <span style="color:#000">unique</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">species</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">plot_id[species</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">species</span> <span style="color:#ce5c00;font-weight:bold">%in%</span> <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">speciesSel]</span><span style="color:#000;font-weight:bold">),</span> 
</span></span><span style="display:flex;"><span>        <span style="color:#000">site</span> <span style="color:#ce5c00;font-weight:bold">%in%</span> <span style="color:#000">na_if</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">siteSel</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;NA&#34;</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">country_iso3</span> <span style="color:#ce5c00;font-weight:bold">%in%</span>  <span style="color:#000">na_if</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">country_iso3Sel</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;NA&#34;</span><span style="color:#000;font-weight:bold">),</span> 
</span></span><span style="display:flex;"><span>        <span style="color:#000">prinv</span> <span style="color:#ce5c00;font-weight:bold">%in%</span> <span style="color:#000">na_if</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">prinvSel</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;NA&#34;</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">permanent</span> <span style="color:#ce5c00;font-weight:bold">%in%</span> <span style="color:#000">na_if</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">permanentSel</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;NA&#34;</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">plot_shape</span> <span style="color:#ce5c00;font-weight:bold">%in%</span> <span style="color:#000">na_if</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">plot_shapeSel</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;NA&#34;</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">teow_biome</span> <span style="color:#ce5c00;font-weight:bold">%in%</span> <span style="color:#000">na_if</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">teow_biomeSel</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;NA&#34;</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">whites_veg_minor</span> <span style="color:#ce5c00;font-weight:bold">%in%</span> <span style="color:#000">na_if</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">whites_veg_minorSel</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;NA&#34;</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">between</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">plot_area</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">plot_areaSel[1]</span><span style="color:#000;font-weight:bold">,</span><span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">plot_areaSel[2]</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">|</span> <span style="color:#000">is.na</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">plot_area</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">between</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">longitude</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">longitudeSel[1]</span><span style="color:#000;font-weight:bold">,</span><span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">longitudeSel[2]</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">|</span> <span style="color:#000">is.na</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">longitude</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">between</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">latitude</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">latitudeSel[1]</span><span style="color:#000;font-weight:bold">,</span><span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">latitudeSel[2]</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">|</span> <span style="color:#000">is.na</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">latitude</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">between</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">min_diam_thresh</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">min_diam_threshSel[1]</span><span style="color:#000;font-weight:bold">,</span><span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">min_diam_threshSel[2]</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">|</span> <span style="color:#000">is.na</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">min_diam_thresh</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">between</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ba_ha</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">ba_haSel[1]</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">ba_haSel[2]</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">|</span> <span style="color:#000">is.na</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ba_ha</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">between</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">agb_ha</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">agb_haSel[1]</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">agb_haSel[2]</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">|</span> <span style="color:#000">is.na</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">agb_ha</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">between</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">n_stems_ge5</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">n_stems_ge5Sel[1]</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">n_stems_ge5Sel[2]</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">|</span> <span style="color:#000">is.na</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">n_stems_ge5</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">between</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">richness</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">richnessSel[1]</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">richnessSel[2]</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">|</span> <span style="color:#000">is.na</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">richness</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">between</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">n_census</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">n_censusSel[1]</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">n_censusSel[2]</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">|</span> <span style="color:#000">is.na</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">n_census</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">between</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">bio1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">bio1Sel[1]</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">bio1Sel[2]</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">|</span> <span style="color:#000">is.na</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">bio1</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">between</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">bio12</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">bio12Sel[1]</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">bio12Sel[2]</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">|</span> <span style="color:#000">is.na</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">bio12</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">between</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">travel_time_city</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">travel_time_citySel[1]</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">travel_time_citySel[2]</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">|</span> <span style="color:#000">is.na</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">travel_time_city</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">between</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">elevation</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">elevationSel[1]</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">elevationSel[2]</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">|</span> <span style="color:#000">is.na</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">elevation</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">between</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">forest_height</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">forest_heightSel[1]</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">forest_heightSel[2]</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">|</span> <span style="color:#000">is.na</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">forest_height</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">between</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">soil_org_c_densit</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">soil_org_c_densitSel[1]</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">soil_org_c_densitSel[2]</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">|</span> <span style="color:#000">is.na</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">soil_org_c_densit</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">between</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">soil_sand</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">soil_sandSel[1]</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">soil_sandSel[2]</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">|</span> <span style="color:#000">is.na</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">soil_sand</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">filter</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">teow_biomeSelNA</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">is.na</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">teow_biome</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#204a87;font-weight:bold">else</span> <span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">filter</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">whites_veg_minorSelNA</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">is.na</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">whites_veg_minor</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#204a87;font-weight:bold">else</span> <span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">filter</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">min_diam_threshSelNA</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">is.na</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">min_diam_thresh</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#204a87;font-weight:bold">else</span> <span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">filter</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">bio1SelNA</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">is.na</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">bio1</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#204a87;font-weight:bold">else</span> <span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">filter</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">bio12SelNA</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">is.na</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">bio12</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#204a87;font-weight:bold">else</span> <span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">filter</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">travel_time_citySelNA</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">is.na</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">travel_time_city</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#204a87;font-weight:bold">else</span> <span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">filter</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">elevationSelNA</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">is.na</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">elevation</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#204a87;font-weight:bold">else</span> <span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">filter</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">forest_heightSelNA</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">is.na</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">forest_height</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#204a87;font-weight:bold">else</span> <span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">filter</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">soil_org_c_densitSelNA</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">is.na</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">soil_org_c_densit</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#204a87;font-weight:bold">else</span> <span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">filter</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">soil_sandSelNA</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">is.na</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">soil_sand</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#204a87;font-weight:bold">else</span> <span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">})</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">output</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">mapOutput</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">renderLeaflet</span><span style="color:#000;font-weight:bold">({</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">leaflet</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">addTiles</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">urlTemplate</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">mapbox_url</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">options</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">tileOptions</span><span style="color:#000;font-weight:bold">(</span>
</span></span><span style="display:flex;"><span>          <span style="color:#000">maxZoom</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">18</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">setView</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">lng</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">30</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">lat</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">-15</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">zoom</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">4</span><span style="color:#000;font-weight:bold">)</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">})</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">toListen</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">reactive</span><span style="color:#000;font-weight:bold">({</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">list</span><span style="color:#000;font-weight:bold">(</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">speciesSel</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">tableColSel</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">pointHiSel</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">siteSel</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">country_iso3Sel</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">prinvSel</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">plot_areaSel</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">permanentSel</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">plot_shapeSel</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">teow_biomeSel</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">teow_biomeSelNA</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">whites_veg_minorSel</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">whites_veg_minorSelNA</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">longitudeSel</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">latitudeSel</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">elevationSel</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">elevationSelNA</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">min_diam_threshSel</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">min_diam_threshSelNA</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">ba_haSel</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">agb_haSel</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">n_stems_ge5Sel</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">richnessSel</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">n_censusSel</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">bio1Sel</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">bio1SelNA</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">bio12Sel</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">bio12SelNA</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">travel_time_citySel</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">travel_time_citySelNA</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">forest_heightSel</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">forest_heightSelNA</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">soil_org_c_densitSel</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">soil_org_c_densitSelNA</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">soil_sandSel</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">soil_sandSelNA</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">})</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">observeEvent</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">toListen</span><span style="color:#000;font-weight:bold">(),</span> <span style="color:#000;font-weight:bold">{</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#000">leafletProxy</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;mapOutput&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">clearMarkers</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>      <span style="color:#000">clearControls</span><span style="color:#000;font-weight:bold">()</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">nrow</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">plotsFil</span><span style="color:#000;font-weight:bold">())</span> <span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">pointHiSel</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#4e9a06">&#34;None&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">is.numeric</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">plotsFil</span><span style="color:#000;font-weight:bold">()</span><span style="color:#000">[</span><span style="color:#000">[names</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">column_lookup</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000">[</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">unname</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">unlist</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">lapply</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">column_lookup</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;[[&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;label&#34;</span><span style="color:#000;font-weight:bold">)))</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">pointHiSel]]]</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#000">pal</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">colorNumeric</span><span style="color:#000;font-weight:bold">(</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">palette</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">scico</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">n</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">100</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">palette</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;imola&#34;</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">domain</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">plotsFil</span><span style="color:#000;font-weight:bold">()</span><span style="color:#000">[</span><span style="color:#000">[names</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">column_lookup</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000">[</span>
</span></span><span style="display:flex;"><span>              <span style="color:#000">unname</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">unlist</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">lapply</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">column_lookup</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;[[&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;label&#34;</span><span style="color:#000;font-weight:bold">)))</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">pointHiSel]]]</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">na.color</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;darkgrey&#34;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span> <span style="color:#204a87;font-weight:bold">else</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#000">pal</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">colorFactor</span><span style="color:#000;font-weight:bold">(</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">palette</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">scico</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">n</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">length</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">unique</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">plotsFil</span><span style="color:#000;font-weight:bold">()</span><span style="color:#000">[</span><span style="color:#000">[names</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">column_lookup</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000">[</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#000">unname</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">unlist</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">lapply</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">column_lookup</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;[[&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;label&#34;</span><span style="color:#000;font-weight:bold">)))</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">pointHiSel]]]</span><span style="color:#000;font-weight:bold">)),</span> 
</span></span><span style="display:flex;"><span>              <span style="color:#000">palette</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;imola&#34;</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">domain</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">plotsFil</span><span style="color:#000;font-weight:bold">()</span><span style="color:#000">[</span><span style="color:#000">[names</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">column_lookup</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000">[</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#000">unname</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">unlist</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">lapply</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">column_lookup</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;[[&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;label&#34;</span><span style="color:#000;font-weight:bold">)))</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">pointHiSel]]]</span>
</span></span><span style="display:flex;"><span>          <span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">leafletProxy</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;mapOutput&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>          <span style="color:#000">addCircleMarkers</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">data</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">plotsFil</span><span style="color:#000;font-weight:bold">(),</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">popup</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#ce5c00;font-weight:bold">~</span><span style="color:#000">label</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">radius</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">4</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">color</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;black&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">opacity</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">weight</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">fillOpacity</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> 
</span></span><span style="display:flex;"><span>            <span style="color:#000">fillColor</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#ce5c00;font-weight:bold">~</span><span style="color:#000">pal</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">plotsFil</span><span style="color:#000;font-weight:bold">()</span><span style="color:#000">[</span><span style="color:#000">[names</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">column_lookup</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000">[</span>
</span></span><span style="display:flex;"><span>              <span style="color:#000">unname</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">unlist</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">lapply</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">column_lookup</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;[[&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;label&#34;</span><span style="color:#000;font-weight:bold">)))</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">pointHiSel]]]</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>          <span style="color:#000">addLegend</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">position</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;bottomright&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">pal</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">pal</span><span style="color:#000;font-weight:bold">,</span> 
</span></span><span style="display:flex;"><span>            <span style="color:#000">values</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">plotsFil</span><span style="color:#000;font-weight:bold">()</span><span style="color:#000">[</span><span style="color:#000">[names</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">column_lookup</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000">[</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#000">unname</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">unlist</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">lapply</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">column_lookup</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;[[&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;label&#34;</span><span style="color:#000;font-weight:bold">)))</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">pointHiSel]]]</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">title</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">unname</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">unlist</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">lapply</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">column_lookup</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;[[&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;html&#34;</span><span style="color:#000;font-weight:bold">)))</span><span style="color:#000">[</span>
</span></span><span style="display:flex;"><span>              <span style="color:#000">unname</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">unlist</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">lapply</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">column_lookup</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;[[&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;label&#34;</span><span style="color:#000;font-weight:bold">)))</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">pointHiSel]</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">opacity</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">}</span> <span style="color:#204a87;font-weight:bold">else</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">leafletProxy</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;mapOutput&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>          <span style="color:#000">addCircleMarkers</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">data</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">plotsFil</span><span style="color:#000;font-weight:bold">(),</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">popup</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#ce5c00;font-weight:bold">~</span><span style="color:#000">label</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">radius</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">4</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">color</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;black&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">opacity</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">weight</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">fillOpacity</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">fillColor</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;tomato&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">})</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">observeEvent</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">toListen</span><span style="color:#000;font-weight:bold">(),</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">plots_df</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">plotsFil</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">st_drop_geometry</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">dplyr</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">select</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">names</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">column_lookup</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000">[</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">unlist</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">lapply</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">column_lookup</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;[[&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;label&#34;</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">%in%</span> <span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">tableColSel]</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">names</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">plots_df</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">unlist</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">lapply</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">column_lookup</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;[[&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;label&#34;</span><span style="color:#000;font-weight:bold">))</span><span style="color:#000">[</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">match</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">names</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">plots_df</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#000">names</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">column_lookup</span><span style="color:#000;font-weight:bold">))</span><span style="color:#000">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">output</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">tableOutput</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">renderDT</span><span style="color:#000;font-weight:bold">({</span> 
</span></span><span style="display:flex;"><span>      <span style="color:#000">datatable</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">plots_df</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">rownames</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">FALSE</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">options</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">list</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">autoWidth</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">scrollX</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">})</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">})</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#000">observeEvent</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">input</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">more_info</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">showModal</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">modalDialog</span><span style="color:#000;font-weight:bold">(</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">title</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">HTML</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">paste0</span><span style="color:#000;font-weight:bold">(</span>
</span></span><span style="display:flex;"><span>          <span style="color:#000">tags</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">p</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;This app is designed to provide quick filtering of the plot data in the SEOSAW network, based on various plot attributes and metadata.&#34;</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>          <span style="color:#000">tags</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">p</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;For more information on SEOSAW, visit: &#34;</span><span style="color:#000;font-weight:bold">,</span> 
</span></span><span style="display:flex;"><span>            <span style="color:#000">tags</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">a</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">href</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;https://seosaw.github.io&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;https://seosaw.github.io&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">target</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;_blank&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>          <span style="color:#000">tags</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">p</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Created by John L. Godlee (&#34;</span><span style="color:#000;font-weight:bold">,</span> 
</span></span><span style="display:flex;"><span>            <span style="color:#000">tags</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">a</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">href</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;mailto:john.godlee@ed.ac.uk&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;john.godlee@ed.ac.uk&#34;</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>            <span style="color:#4e9a06">&#34;)&#34;</span><span style="color:#000;font-weight:bold">))),</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">easyClose</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">footer</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">NULL</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">))</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">})</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">shinyApp</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ui</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">server</span><span style="color:#000;font-weight:bold">)</span>
</span></span></code></pre></div>
</main>

  <footer>
  <hr/>
  John L. Godlee | 
  <a href="mailto:johngodlee@gmail.com">johngodlee@gmail.com</a> |
  <a href="http://johngodlee.xyz//index.xml">RSS</a>

  </footer>
  </body>
</html>

