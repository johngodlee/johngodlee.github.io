<!DOCTYPE html>
<html lang="en-gb">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>John L. Godlee</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
  </head>

  <body>
    <nav>
    <ul class="menu">
      
      <li><a href="/">John L. Godlee</a></li>
      
      <li><a href="/cv">CV</a></li>
      
      <li><a href="/works">Works</a></li>
      
    </ul>
    <hr/>
    </nav>


<div>
<h1>Visualising Survey Data with Likert Scales</h1>

<h2>2017-09-16</h2>
</div>

<main>
<p>Recently I was offered a small amount of consulting work. A company had conducted a survey over Survey Monkey to look at how satisfied and engaged their employees were and my job was to analyse these data to try and tease out any trends. Finally I had to visualise the data in a way that the company could put together in a little report and talk about in a meeting. Obviously I can&rsquo;t show any of the graphs or data that I analysed for that job, because of confidentiality laws, so I&rsquo;ve created an example dataset that I can use to demonstrate some of the methods I came up with for effectively visualising the data.</p>
<p>I used <code>R</code> to analyse the data, purely because that is what I know, though I know the company does the vast majority of their stuff in Excel.</p>
<p>If you want to follow along you can download the data from <a href="/files/likert/example.csv">here</a>
 and an example script from <a href="/files/likert/example_likert.R">here</a>
</p>
<h1 id="cleaning-the-data">Cleaning the data</h1>
<p>First I need to install some packages, set the working directory and load the data into R:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#8f5902;font-style:italic"># Packages</span>
<span style="color:#000">library</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">dplyr</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">library</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">tidyr</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">library</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ggplot2</span><span style="color:#000;font-weight:bold">)</span>

<span style="color:#8f5902;font-style:italic"># Set the working directory</span>
<span style="color:#000">setwd</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;~/survey_data&#34;</span><span style="color:#000;font-weight:bold">)</span>

<span style="color:#8f5902;font-style:italic"># Import data</span>
<span style="color:#000">survey</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">read.csv</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;example.csv&#34;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>Then I can have a look at the data and see that Survey Monkey has given each respondent a row, each column indicates an answer for a given question, e.g. &ldquo;I would work for comX again - Disagree&rdquo;, &ldquo;What type of employee are you - Admin&rdquo;. This means that in any given column many of the cells are empty, and it violates one of the golden rules of making a table of data, that each column should contain unique data.</p>
<p>I have no idea why survey monkey thinks this is a good way to format their data output, but luckily it&rsquo;s easy to remedy using some <code>dplyr</code> and <code>tidyr</code> magic</p>
<p>First I need to check for any NA and replace them with blank space:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#000">survey</span><span style="color:#000">[is.na</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">survey</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000">]</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#4e9a06">&#39;&#39;</span>
</code></pre></div><p>Then I need to get rid of the first row which contains the names of the answer options for each question, as it&rsquo;s not useful:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#000">survey</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">survey</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">slice</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#ce5c00;font-weight:bold">:</span><span style="color:#000">n</span><span style="color:#000;font-weight:bold">())</span>
</code></pre></div><p>Then I need to concatenate groups of columns so that each column contains the answers for a unique question:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#8f5902;font-style:italic"># Split the data frame into a data frame for each question</span>
<span style="color:#000">survey_employee</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">survey_header</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">select</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#ce5c00;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">4</span><span style="color:#000;font-weight:bold">)</span> 

<span style="color:#000">survey_again</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">survey_header</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">select</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">5</span><span style="color:#ce5c00;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">9</span><span style="color:#000;font-weight:bold">)</span>

<span style="color:#000">survey_always</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">survey_header</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">select</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">10</span><span style="color:#ce5c00;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">14</span><span style="color:#000;font-weight:bold">)</span>

<span style="color:#000">survey_line</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">survey_header</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">select</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">15</span><span style="color:#ce5c00;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">19</span><span style="color:#000;font-weight:bold">)</span>

<span style="color:#000">survey_think</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">survey_header</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">select</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">20</span><span style="color:#ce5c00;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">24</span><span style="color:#000;font-weight:bold">)</span>

<span style="color:#8f5902;font-style:italic"># Concatenate columns in each data frame:</span>
<span style="color:#000">what_type_of_employee_are_you</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">unite</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">survey_employee</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">what_type_of_employee_are_you</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#ce5c00;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">4</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">sep</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">remove</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#3465a4">F</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000">[1]</span>
<span style="color:#000">i_would_work_for_comx_again</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">unite</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">survey_again</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">i_would_work_for_comx_again</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#ce5c00;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">sep</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">remove</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#3465a4">F</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000">[1]</span>
<span style="color:#000">i_am_always_busy_at_comx</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">unite</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">survey_always</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">i_am_always_busy_at_comx</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#ce5c00;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">sep</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">remove</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#3465a4">F</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000">[1]</span>
<span style="color:#000">my_line_manager_values_my_contributions</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">unite</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">survey_line</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">my_line_manager_values_my_contributions</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#ce5c00;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">sep</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">remove</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#3465a4">F</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000">[1]</span>
<span style="color:#000">i_think_directors_are_paid_the_right_amount</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">unite</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">survey_think</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">i_think_directors_are_paid_the_right_amount</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#ce5c00;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">sep</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">remove</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#3465a4">F</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000">[1]</span>

<span style="color:#8f5902;font-style:italic"># Combine into data frame</span>
<span style="color:#000">survey_cond</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">data.frame</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">what_type_of_employee_are_you</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">i_would_work_for_comx_again</span><span style="color:#000;font-weight:bold">,</span>
			<span style="color:#000">i_am_always_busy_at_comx</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">my_line_manager_values_my_contributions</span><span style="color:#000;font-weight:bold">,</span>
			<span style="color:#000">i_think_directors_are_paid_the_right_amount</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>Now each column has all the answers for a question, and no two columns contain data relating to the same question.</p>
<h1 id="making-pivot-tables">Making pivot tables</h1>
<p>I can convert the answers for each question into a numerical form, centred on zero:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#000">survey_cond_num</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">survey_cond</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">mutate</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">i_would_work_for_comx_again</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">recode</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">i_would_work_for_comx_again</span><span style="color:#000;font-weight:bold">,</span>
		<span style="color:#4e9a06">&#34;Strongly disagree&#34;</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">-2</span><span style="color:#000;font-weight:bold">,</span>
		<span style="color:#4e9a06">&#34;Disagree&#34;</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">-1</span><span style="color:#000;font-weight:bold">,</span>
		<span style="color:#4e9a06">&#34;Neither agree nor disagree&#34;</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
		<span style="color:#4e9a06">&#34;Agree&#34;</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span>
		<span style="color:#4e9a06">&#34;Strongly agree&#34;</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">),</span>
	<span style="color:#000">i_am_always_busy_at_comx</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">recode</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">i_am_always_busy_at_comx</span><span style="color:#000;font-weight:bold">,</span>
		<span style="color:#4e9a06">&#34;Strongly disagree&#34;</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">-2</span><span style="color:#000;font-weight:bold">,</span>
		<span style="color:#4e9a06">&#34;Disagree&#34;</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">-1</span><span style="color:#000;font-weight:bold">,</span>
		<span style="color:#4e9a06">&#34;Neither agree nor disagree&#34;</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
		<span style="color:#4e9a06">&#34;Agree&#34;</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span>
		<span style="color:#4e9a06">&#34;Strongly agree&#34;</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">),</span>
	<span style="color:#000">my_line_manager_values_my_contributions</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">recode</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">my_line_manager_values_my_contributions</span><span style="color:#000;font-weight:bold">,</span>
		<span style="color:#4e9a06">&#34;strongly disagree&#34;</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">-2</span><span style="color:#000;font-weight:bold">,</span>
		<span style="color:#4e9a06">&#34;disagree&#34;</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">-1</span><span style="color:#000;font-weight:bold">,</span>
		<span style="color:#4e9a06">&#34;neither agree nor disagree&#34;</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
		<span style="color:#4e9a06">&#34;agree&#34;</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span>
		<span style="color:#4e9a06">&#34;strongly agree&#34;</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">),</span>
	<span style="color:#000">i_think_directors_are_paid_the_right_amount</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">recode</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">i_think_directors_are_paid_the_right_amount</span><span style="color:#000;font-weight:bold">,</span>
		<span style="color:#4e9a06">&#34;strongly disagree&#34;</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">-2</span><span style="color:#000;font-weight:bold">,</span>
		<span style="color:#4e9a06">&#34;disagree&#34;</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">-1</span><span style="color:#000;font-weight:bold">,</span>
		<span style="color:#4e9a06">&#34;neither agree nor disagree&#34;</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
		<span style="color:#4e9a06">&#34;agree&#34;</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span>
		<span style="color:#4e9a06">&#34;strongly agree&#34;</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">))</span>
</code></pre></div><p>Then use this new data frame to create pivot tables for each question, showing how each employee group scored:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#000">heirarchy</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">c</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Director&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Consultant&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;HR&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Admin&#34;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">col_names</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">names</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">select</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">survey_cond</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#ce5c00;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">))</span>

<span style="color:#000">summ_all</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">survey_cond</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">select</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">what_type_of_employee_are_you</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">col_names</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">gather</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">key</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#000">what_type_of_employee_are_you</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">split</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">.$key</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">lapply</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">function</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span><span style="color:#000;font-weight:bold">){</span><span style="color:#000">x</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> <span style="color:#000">group_by</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">what_type_of_employee_are_you</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">value</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
			<span style="color:#000">tally</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
			<span style="color:#000">spread</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">n</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">fill</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
			<span style="color:#000">ungroup</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
			<span style="color:#000">mutate</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">what_type_of_employee_are_you</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">factor</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">what_type_of_employee_are_you</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">levels</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">heirarchy</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
			<span style="color:#000">arrange</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">what_type_of_employee_are_you</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
			<span style="color:#000">select</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">what_type_of_employee_are_you</span><span style="color:#000;font-weight:bold">,</span>
						 <span style="color:#000">`Strongly disagree`</span><span style="color:#000;font-weight:bold">,</span>
						 <span style="color:#000">Disagree</span><span style="color:#000;font-weight:bold">,</span>
						 <span style="color:#000">`Neither agree nor disagree`</span><span style="color:#000;font-weight:bold">,</span>
						 <span style="color:#000">Agree</span><span style="color:#000;font-weight:bold">,</span>
						 <span style="color:#000">`Strongly agree`</span><span style="color:#000;font-weight:bold">)</span>
	<span style="color:#000;font-weight:bold">})</span>

<span style="color:#8f5902;font-style:italic"># Write to csv</span>
<span style="color:#000">for </span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">i</span> <span style="color:#000">in</span> <span style="color:#000">seq_along</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">summ_all</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
	<span style="color:#000">write.csv</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">summ_all[[i]]</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">paste</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;pivot_tables/&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#000">names</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">summ_all[i]</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#4e9a06">&#34;.csv&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">sep</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;&#34;</span><span style="color:#000;font-weight:bold">))</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>These pivot tables can be investigated later on or used to easily create bar charts for each question like the one below:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#8f5902;font-style:italic"># Read in the pivot table csv</span>
<span style="color:#000">pivot</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">read.csv</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;pivot_tables/i_am_always_busy_at_comx.csv&#34;</span><span style="color:#000;font-weight:bold">)</span>

<span style="color:#8f5902;font-style:italic"># Create heirarchies of response order, employee type</span>
<span style="color:#000">resp_order</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">c</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Strongly.disagree&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Disagree&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Neither.agree.nor.disagree&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Agree&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Strongly.agree&#34;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">heirarchy</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">c</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Director&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Consultant&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;HR&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Admin&#34;</span><span style="color:#000;font-weight:bold">)</span>

<span style="color:#8f5902;font-style:italic"># Gather the pivot table into long format</span>
<span style="color:#000">pivot_gather</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">pivot</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">select</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#ce5c00;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">7</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">gather</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">Response</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">Score</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">Strongly.disagree</span><span style="color:#ce5c00;font-weight:bold">:</span><span style="color:#000">Strongly.agree</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">mutate</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">Response</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">factor</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">Response</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">levels</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">resp_order</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">mutate</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">Role</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">factor</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">what_type_of_employee_are_you</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">levels</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">heirarchy</span><span style="color:#000;font-weight:bold">))</span>

<span style="color:#8f5902;font-style:italic"># Create the plot</span>
<span style="color:#000">ggplot</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">pivot_gather</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">aes</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Role</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">y</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Score</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">fill</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Response</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">+</span>
	<span style="color:#000">geom_bar</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stat</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;identity&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">position</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;dodge&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">+</span> 
	<span style="color:#000">scale_fill_brewer</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">palette</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;Blues&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">+</span> 
	<span style="color:#000">theme</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">legend.title</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">element_blank</span><span style="color:#000;font-weight:bold">())</span> <span style="color:#ce5c00;font-weight:bold">+</span> 
	<span style="color:#000">ggtitle</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;I am always busy at comX&#34;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p><img src="/img/likert/question.png" alt="Bar chart of 5 point likert responses"></p>
<h1 id="overall-question-comparison">Overall question comparison</h1>
<p>To see which questions get the worst score overall I can plot them on a horizontal bar chart, ordering the bars and colouring them according to the score:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#000">survey_total_q</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">survey_cond_num</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
<span style="color:#000">select</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#ce5c00;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">summarise_all</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">funs</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">mean</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">.,</span> <span style="color:#000">na.rm</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">)))</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">gather</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;question&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#4e9a06">&#34;mean_score&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">na.omit</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">arrange</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">desc</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">mean_score</span><span style="color:#000;font-weight:bold">))</span>

<span style="color:#000">ggplot</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">survey_total_q</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">aes</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">reorder</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">question</span><span style="color:#000;font-weight:bold">,</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#000">mean_score</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#000">y</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">mean_score</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">fill</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">mean_score</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">+</span>
	<span style="color:#000">geom_bar</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stat</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;identity&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">+</span>
	<span style="color:#000">coord_flip</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">+</span>
	<span style="color:#000">theme</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">axis.title.y</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">element_blank</span><span style="color:#000;font-weight:bold">())</span> <span style="color:#ce5c00;font-weight:bold">+</span>
	<span style="color:#000">scale_fill_continuous</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">low</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;#E33235&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">high</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;#2183EB&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">+</span>
	<span style="color:#000">theme</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">legend.position</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;none&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">+</span>
	<span style="color:#000">ylab</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;`Mean Likert Score&#34;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p><img src="/img/likert/score_order.png" alt="Mean likert score"></p>
<p>I can also break those bars down by which employee groups contribute most of the score for that question:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#000">survey_total_job</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">survey_cond_num</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">select</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#ce5c00;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">group_by</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">what_type_of_employee_are_you</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">na.omit</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">summarise_all</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">funs</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">sum</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">gather</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;question&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#4e9a06">&#34;total_score&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">mutate</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">what_type_of_employee_are_you</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">strrep</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">c</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Director&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Consultant&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;HR&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Admin&#34;</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#000">times</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">group_by</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">question</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">what_type_of_employee_are_you</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">filter</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">question</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#4e9a06">&#34;Role&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">arrange</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">desc</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">total_score</span><span style="color:#000;font-weight:bold">))</span>

<span style="color:#000">ggplot</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">survey_total_job</span><span style="color:#000">[order</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">survey_total_job</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">total_score</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">decreasing</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#3465a4">T</span><span style="color:#000;font-weight:bold">),</span><span style="color:#000">]</span><span style="color:#000;font-weight:bold">,</span>
			 <span style="color:#000">aes</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">reorder</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">question</span><span style="color:#000;font-weight:bold">,</span><span style="color:#000">total_score</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#000">y</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">total_score</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">fill</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">what_type_of_employee_are_you</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">+</span>
	<span style="color:#000">geom_bar</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stat</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;identity&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">+</span>
	<span style="color:#000">coord_flip</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">theme</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">axis.title.y</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">element_blank</span><span style="color:#000;font-weight:bold">())</span> <span style="color:#ce5c00;font-weight:bold">+</span>
	<span style="color:#000">scale_fill_brewer</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">limits</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">heirarchy</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">palette</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;Dark2&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">+</span>
	<span style="color:#000">scale_x_discrete</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">limits</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">as.vector</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">survey_total_q</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">question</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">+</span>
	<span style="color:#000">theme</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">axis.text.x</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">element_blank</span><span style="color:#000;font-weight:bold">(),</span>
				<span style="color:#000">axis.ticks.x</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">element_blank</span><span style="color:#000;font-weight:bold">())</span> <span style="color:#ce5c00;font-weight:bold">+</span>
	<span style="color:#000">guides</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">fill</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">guide_legend</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">title</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;Role&#34;</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">+</span>
	<span style="color:#000">xlab</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Total Likert Score&#34;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p><img src="/img/likert/stack.png" alt="Stacked likert scores"></p>
<p>Finally, I can get a general sense of the satisfaction of each employee by seeing the total score given by that employee:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#000">role_total</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">survey_cond_num</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">select</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#ce5c00;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">replace</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">is.na</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">.)</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">group_by</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">what_type_of_employee_are_you</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">summarise_all</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">funs</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">sum</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">mutate</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">sum</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">rowSums</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">.[2</span><span style="color:#ce5c00;font-weight:bold">:</span><span style="color:#000">length</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">.)]</span><span style="color:#000;font-weight:bold">))</span>

<span style="color:#000">ggplot</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">role_total</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">aes</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">what_type_of_employee_are_you</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">y</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">sum</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">fill</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">what_type_of_employee_are_you</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">+</span>
	<span style="color:#000">geom_bar</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stat</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;identity&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">+</span>
	<span style="color:#000">ylab</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Total Likert Score&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">+</span>
	<span style="color:#000">scale_x_discrete</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">limits</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">heirarchy</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">+</span>
	<span style="color:#000">guides</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">fill</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">guide_legend</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">title</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;Role&#34;</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">+</span>
	<span style="color:#000">scale_fill_brewer</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">palette</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;Dark2&#34;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p><img src="/img/likert/total.png" alt="Total Likert score per employee type"></p>
<h1 id="update-27th-oct-2017">Update 27th Oct. 2017</h1>
<p>I ended up doing a bit  more with survey data for an undergraduate dissertation student that was looking at how gender affected thoughts towards sustainable activity within the home, and how work was partitioned in different types of household.</p>
<p>One of the best methods we came up with for graphically representing correlations in responses to certain questions and the demographic category a person fit into was the bubble plot. I guess if you wanted to statistically analyse this data you would use a chi-squared test.</p>
<p>The fake data for the plot below can be found <a href="/files/likert/sust_behaviour.csv">here</a>
 and a lookup table for the contents of each question column can be found <a href="/files/likert/question_lookup.csv">here</a>
. The data <code>.csv</code> shows each row as a respondent, along with how many hours of housework they do, their gender, the codes for checkboxes they ticked of different sustainable activities they did, related to waste management and water management, and lastly a self-evaluated measure of how much they consider sustainable actions in their day to day life.</p>
<p>So I want to make a bubble plot of <code>age</code> vs. how often people think about sustainable activities (<code>sustainability_daily_think</code>):</p>
<p>First, make a summary data frame which counts the number of occurrences of each unique x y combination:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#8f5902;font-style:italic"># Load data</span>
<span style="color:#000">sust_data</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">read.csv</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;sust_behaviour.csv&#34;</span><span style="color:#000;font-weight:bold">)</span>

<span style="color:#8f5902;font-style:italic"># Make summary</span>
<span style="color:#000">sust_bubble</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">sust_data</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">group_by</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">age</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">sustainability_daily_think</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">tally</span><span style="color:#000;font-weight:bold">()</span>
</code></pre></div><p>Then make the plot:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#000">ggplot</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">sust_bubble</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">aes</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">age</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">y</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">sustainability_daily_think</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">+</span>
	<span style="color:#000">geom_point</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">aes</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">size</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">n</span><span style="color:#000;font-weight:bold">))</span>
</code></pre></div><p><img src="/img/likert/bubble.png" alt="Bubble map"></p>
<p>Another thing I managed to crack was how to make a diverging bar chart in ggplot2, so it looks similar to the ones you can make with the <a href="https://cran.r-project.org/web/packages/HH/index.html" target="_blank">HH package</a>
.</p>
<p>Get set up, import data etc.:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#8f5902;font-style:italic"># Packages</span>
<span style="color:#000">library</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ggplot2</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">library</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">dplyr</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">library</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">tidyr</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">library</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">RColorBrewer</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">library</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">R.utils</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">library</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">tidytext</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">library</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">wordcloud</span><span style="color:#000;font-weight:bold">)</span>

<span style="color:#8f5902;font-style:italic"># setwd to source file</span>
<span style="color:#000">setwd</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">dirname</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">rstudioapi</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">getActiveDocumentContext</span><span style="color:#000;font-weight:bold">()</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">path</span><span style="color:#000;font-weight:bold">))</span>

<span style="color:#8f5902;font-style:italic"># Load data </span>
<span style="color:#000">sust_data</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">read.csv</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;sust_behaviour.csv&#34;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">question_lookup</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">read.csv</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;question_lookup.csv&#34;</span><span style="color:#000;font-weight:bold">)</span>

<span style="color:#8f5902;font-style:italic"># Make ordered factor</span>
<span style="color:#000">sust_data</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">sustainability_daily_think</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">factor</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">sust_data</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">sustainability_daily_think</span><span style="color:#000;font-weight:bold">,</span> 
	<span style="color:#000">levels</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">c</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Never&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Rarely&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Sometimes&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Often&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;All the time&#34;</span><span style="color:#000;font-weight:bold">),</span> 
	<span style="color:#000">ordered</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">)</span>

<span style="color:#8f5902;font-style:italic"># Remove NAs </span>
<span style="color:#000">sust_data</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">sust_data[</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">is.na</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">sust_data</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">sustainability_daily_think</span><span style="color:#000;font-weight:bold">),</span><span style="color:#000">]</span>
</code></pre></div><p>anipulate the data so it&rsquo;s ready for plotting:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#8f5902;font-style:italic"># Create a summary dataframe of likert responses to a single question</span>
<span style="color:#000">sust_think_summ</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">sust_data</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">group_by</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">gender</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">sustainability_daily_think</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">tally</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">mutate</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">perc</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">n</span> <span style="color:#ce5c00;font-weight:bold">/</span> <span style="color:#000">sum</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">n</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#0000cf;font-weight:bold">100</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">dplyr</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">select</span><span style="color:#000;font-weight:bold">(</span> <span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#000">n</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">group_by</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">gender</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">spread</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">sustainability_daily_think</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">perc</span><span style="color:#000;font-weight:bold">)</span>

<span style="color:#000">sust_think_summ_hi_lo</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">sust_think_summ</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">mutate</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">midlow</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Sometimes</span> <span style="color:#ce5c00;font-weight:bold">/</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span>
				 <span style="color:#000">midhigh</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Sometimes</span> <span style="color:#ce5c00;font-weight:bold">/</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">dplyr</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">select</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">gender</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">Never</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">Rarely</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">midlow</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">midhigh</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">Often</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">`All the time`</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">gather</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">key</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gender</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">value</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">perc</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">`colnames&lt;-`</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">c</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;gender&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;response&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;perc&#34;</span><span style="color:#000;font-weight:bold">))</span>


<span style="color:#8f5902;font-style:italic"># Split data into high and low groups</span>
<span style="color:#000">sust_think_summ_hi</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">sust_think_summ_hi_lo</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">filter</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">response</span> <span style="color:#ce5c00;font-weight:bold">%in%</span> <span style="color:#000">c</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;All the time&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Often&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;midhigh&#34;</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">mutate</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">response</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">factor</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">response</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">levels</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">c</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;All the time&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Often&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;midhigh&#34;</span><span style="color:#000;font-weight:bold">)))</span>

<span style="color:#000">sust_think_summ_lo</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">sust_think_summ_hi_lo</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">filter</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">response</span> <span style="color:#ce5c00;font-weight:bold">%in%</span> <span style="color:#000">c</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;midlow&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Rarely&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Never&#34;</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
	<span style="color:#000">mutate</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">response</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">factor</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">response</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">levels</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">c</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Never&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Rarely&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;midlow&#34;</span><span style="color:#000;font-weight:bold">)))</span>
</code></pre></div><p>Construct the plot:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#8f5902;font-style:italic"># Define colour palette and associate with locations</span>
<span style="color:#000">legend_pal</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">brewer.pal</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">name</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;RdBu&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">n</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">legend_pal</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">insert</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">legend_pal</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">ats</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">legend_pal[3]</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">legend_pal</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">gsub</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;#F7F7F7&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;#9C9C9C&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">legend_pal</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">names</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">legend_pal</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">c</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;All the time&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Often&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;midhigh&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;midlow&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Rarely&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Never&#34;</span> <span style="color:#000;font-weight:bold">)</span>

<span style="color:#8f5902;font-style:italic"># Make plot</span>
<span style="color:#000">ggplot</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">+</span> 
	<span style="color:#000">geom_bar</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">data</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">sust_think_summ_hi</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">aes</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gender</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">y</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">perc</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">fill</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">response</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#000">stat</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;identity&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">+</span>
	<span style="color:#000">geom_bar</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">data</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">sust_think_summ_lo</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">aes</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">gender</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">y</span><span style="color:#ce5c00;font-weight:bold">=-</span><span style="color:#000">perc</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">fill</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">response</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#000">stat</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;identity&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">+</span> 
	<span style="color:#000">geom_hline</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">yintercept</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">color</span> <span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">c</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;black&#34;</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">+</span> 
	<span style="color:#000">scale_fill_manual</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">values</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">legend_pal</span><span style="color:#000;font-weight:bold">,</span> 
		<span style="color:#000">breaks</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">c</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;All the time&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Often&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;midhigh&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Rarely&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Never&#34;</span><span style="color:#000;font-weight:bold">),</span>
		<span style="color:#000">labels</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">c</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;All the time&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Often&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Sometimes&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Rarely&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Never&#34;</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">+</span>
	<span style="color:#000">coord_flip</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">+</span> 
	<span style="color:#000">labs</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;Gender&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">y</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;Percentage of respondents (%)&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">+</span> 
	<span style="color:#000">ggtitle</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">question_lookup</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">survey_question[question_lookup</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">column_title</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#4e9a06">&#34;sustainability_daily_think&#34;</span><span style="color:#000">]</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">+</span>
	<span style="color:#000">theme_classic</span><span style="color:#000;font-weight:bold">()</span> 
</code></pre></div><p><img src="/img/likert/div_bar.png" alt="Diverging likert responses"></p>

</main>

  <footer>
  <hr/>
  John L. Godlee <a href="mailto:johngodlee@gmail.com">johngodlee@gmail.com</a>
  
  </footer>
  </body>
</html>

