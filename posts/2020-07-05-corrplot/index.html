<!DOCTYPE html>
<html lang="en-gb">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>John L. Godlee</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    </head>

  <body>
    <nav>
    <ul class="menu">
      
      <li><a href="/">John L. Godlee</a></li>
      
      <li><a href="/cv">CV</a></li>
      
      <li><a href="/works">Works</a></li>
      
    </ul>
    <hr/>
    </nav>


<div>
<h1>Pretty correlation matrices with ggplot</h1>

<h2>2020-07-05</h2>
</div>

<main>
<p>I needed to make a correlation matrix plot to show the relationships between all variables in a structural equation model I was writing. I created a function which takes a dataframe of numeric variables and returns a <code>ggplot2</code> object.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#8f5902;font-style:italic">#&#39; Create a pretty correlation matrix plot</span>
<span style="color:#8f5902;font-style:italic">#&#39;</span>
<span style="color:#8f5902;font-style:italic">#&#39; @param x dataframe of numeric variables to correlate</span>
<span style="color:#8f5902;font-style:italic">#&#39;</span>
<span style="color:#8f5902;font-style:italic">#&#39; @return ggplot object with correlogram</span>
<span style="color:#8f5902;font-style:italic">#&#39; </span>
<span style="color:#8f5902;font-style:italic">#&#39; @examples</span>
<span style="color:#8f5902;font-style:italic">#&#39; data(iris)</span>
<span style="color:#8f5902;font-style:italic">#&#39; corrplot(iris[,1:4])</span>
<span style="color:#8f5902;font-style:italic">#&#39; </span>
<span style="color:#8f5902;font-style:italic">#&#39; @import ggplot2 </span>
<span style="color:#8f5902;font-style:italic">#&#39; @importFrom psych corr.test</span>
<span style="color:#8f5902;font-style:italic">#&#39;</span>
<span style="color:#000">corrplot</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">function</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">col</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">c</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;red&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;white&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;blue&#34;</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#204a87;font-weight:bold">...</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#000">corr</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">psych</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">corr.test</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">...</span><span style="color:#000;font-weight:bold">)</span> 
  <span style="color:#000">corr_ci</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">data.frame</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">raw.lower</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">corr</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">ci</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">lower</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">raw.r</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">corr</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">ci</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">r</span><span style="color:#000;font-weight:bold">,</span> 
    <span style="color:#000">raw.upper</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">corr</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">ci</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">upper</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">raw.p</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">corr</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">ci</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">p</span><span style="color:#000;font-weight:bold">,</span> 
    <span style="color:#000">adj.lower</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">corr</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">ci.adj</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">lower.adj</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">adj.upper</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">corr</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">ci.adj</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">upper.adj</span><span style="color:#000;font-weight:bold">)</span>
  <span style="color:#000">corr_ci</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">vars</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">row.names</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">corr_ci</span><span style="color:#000;font-weight:bold">)</span>
  <span style="color:#000">corr_ci</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">conf_x</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">unlist</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">sapply</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#ce5c00;font-weight:bold">:</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">length</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span><span style="color:#000;font-weight:bold">)</span><span style="color:#0000cf;font-weight:bold">-1</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#000">function</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">){</span>
      <span style="color:#000">c</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#ce5c00;font-weight:bold">:</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">length</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span><span style="color:#000;font-weight:bold">)</span><span style="color:#0000cf;font-weight:bold">-1</span><span style="color:#000;font-weight:bold">))</span><span style="color:#000">[i</span><span style="color:#ce5c00;font-weight:bold">:</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">length</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span><span style="color:#000;font-weight:bold">)</span><span style="color:#0000cf;font-weight:bold">-1</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000">]</span>
    <span style="color:#000;font-weight:bold">}))</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#0000cf;font-weight:bold">1</span>
  <span style="color:#000">rev_mat</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">length</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span><span style="color:#000;font-weight:bold">)</span><span style="color:#0000cf;font-weight:bold">-1</span><span style="color:#000;font-weight:bold">)</span><span style="color:#ce5c00;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">1</span>
  <span style="color:#000">corr_ci</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">conf_y</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">unlist</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">sapply</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#ce5c00;font-weight:bold">:</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">length</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span><span style="color:#000;font-weight:bold">)</span><span style="color:#0000cf;font-weight:bold">-1</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#000">function</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">){</span>
      <span style="color:#000">rep</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">times</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">rev_mat[i]</span><span style="color:#000;font-weight:bold">)</span>
    <span style="color:#000;font-weight:bold">}))</span>
  <span style="color:#000">n_seq</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#ce5c00;font-weight:bold">:</span><span style="color:#000">length</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span><span style="color:#000;font-weight:bold">)</span>
  <span style="color:#000">corr_ci</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">y_var</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">unlist</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">sapply</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#ce5c00;font-weight:bold">:</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">length</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span><span style="color:#000;font-weight:bold">)</span><span style="color:#0000cf;font-weight:bold">-1</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#000">function</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">){</span>
      <span style="color:#000">rep</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">row.names</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">corr[[1]]</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000">[i]</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">rev_mat[i]</span><span style="color:#000;font-weight:bold">)</span>
    <span style="color:#000;font-weight:bold">}))</span>
  <span style="color:#000">corr_ci</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">x_var</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">unlist</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">sapply</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#ce5c00;font-weight:bold">:</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">length</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span><span style="color:#000;font-weight:bold">)</span><span style="color:#0000cf;font-weight:bold">-1</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#000">function</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">){</span>
      <span style="color:#000">row.names</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">corr[[1]]</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000">[n_seq[i]</span><span style="color:#ce5c00;font-weight:bold">:</span><span style="color:#000">length</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000">]</span>
    <span style="color:#000;font-weight:bold">}))</span>
  <span style="color:#000">corr_ci</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">x_var</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">factor</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">corr_ci</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">x_var</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">levels</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">unique</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">corr_ci</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">x_var</span><span style="color:#000;font-weight:bold">))</span>
  <span style="color:#000">corr_ci</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">y_var</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">factor</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">corr_ci</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">y_var</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">levels</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">unique</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">corr_ci</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">y_var</span><span style="color:#000;font-weight:bold">))</span>
  <span style="color:#000">corr_ci</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">conf</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">corr_ci</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">raw.lower</span> <span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">corr_ci</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">raw.upper</span> <span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span>
  <span style="color:#000">corr_ci</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">raw.r</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">round</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">corr_ci</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">raw.r</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">)</span>

  <span style="color:#000">ggplot2</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">ggplot</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">+</span> 
    <span style="color:#000">ggplot2</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">geom_tile</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">data</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">corr_ci</span><span style="color:#000;font-weight:bold">,</span> 
      <span style="color:#000">ggplot2</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">aes</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">x_var</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">y</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">y_var</span><span style="color:#000;font-weight:bold">,</span> 
        <span style="color:#000">fill</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">raw.r</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#000">colour</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;black&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">+</span> 
    <span style="color:#000">ggplot2</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">geom_text</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">data</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">corr_ci</span><span style="color:#000;font-weight:bold">,</span> 
      <span style="color:#000">ggplot2</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">aes</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">x_var</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">y</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">y_var</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">label</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">raw.r</span><span style="color:#000;font-weight:bold">),</span>
      <span style="color:#000">size</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">+</span> 
    <span style="color:#000">ggplot2</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">geom_point</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">data</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">corr_ci[corr_ci</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">conf</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#204a87;font-weight:bold">FALSE</span><span style="color:#000;font-weight:bold">,</span><span style="color:#000">]</span><span style="color:#000;font-weight:bold">,</span> 
      <span style="color:#000">ggplot2</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">aes</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">x_var</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">y</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">y_var</span><span style="color:#000;font-weight:bold">),</span> 
      <span style="color:#000">fill</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">NA</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">colour</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;black&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">shape</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">21</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">size</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">11</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">+</span> 
    <span style="color:#000">ggplot2</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">scale_fill_gradient2</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">name</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;r&#34;</span><span style="color:#000;font-weight:bold">,</span> 
      <span style="color:#000">low</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">col[1]</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">mid</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">col[2]</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">high</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">col[3]</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">+</span> 
    <span style="color:#000">ggplot2</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">theme_classic</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">+</span> 
    <span style="color:#000">ggplot2</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">labs</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">y</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">+</span> 
    <span style="color:#000">ggplot2</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">coord_equal</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">+</span>
    <span style="color:#000">ggplot2</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">theme</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">legend.position</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;none&#34;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#000">corrplot</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">iris[</span><span style="color:#000;font-weight:bold">,</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#ce5c00;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">4</span><span style="color:#000">]</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><figure><a href="/img_full/corrplot/corrplot.png"><img
          alt="Correlation matrix plot"
          title="Correlation matrix plot"src="/img/corrplot/corrplot.png" 
      /></a></figure>


<p>Here is the actual plot I made for the publication, which additionally colours the axis text to group variables into latent constructs:</p>
<figure><a href="/img_full/corrplot/corrplot_pub.jpg"><img
          alt="Correlation matrix plot for publication"
          title="Correlation matrix plot for publication"src="/img/corrplot/corrplot_pub.png" 
      /></a></figure>



</main>

  <footer>
  <hr/>
  John L. Godlee | 
  <a href="mailto:johngodlee@gmail.com">johngodlee@gmail.com</a> |
  <a href="http://johngodlee.xyz//index.xml">RSS</a>

  </footer>
  </body>
</html>

